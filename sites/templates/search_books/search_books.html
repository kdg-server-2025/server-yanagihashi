{% extends "search_books/base.html" %}
{% load static %}
{% block title %}本を探す{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/search_books/search_books.css' %}">
{% endblock %}

{% block content %}
<section>
    <h2>本を探す</h2>
    <p>キーワードを入力して、お気に入りの本を探しましょう。</p>
    <form method="GET" action="{% url 'search_books:search_books' %}" class="search-form">
        <input type="text" name="query" placeholder="キーワードを入力" value="{{ query }}">
        <button type="submit" class="btn">検索</button>
    </form>
</section>

<section>
    <h2>検索結果</h2>
    {% if books %}
        <div class="book-list">
            {% for book in books %}
                <div class="book-card">
                    <img src="{{ book.volumeInfo.imageLinks.thumbnail }}" alt="{{ book.volumeInfo.title }}">
                    <h3>{{ book.volumeInfo.title }}</h3>
                    <p>著者: {{ book.volumeInfo.authors|join:", " }}</p>
                    <p>出版日: {{ book.volumeInfo.publishedDate }}</p>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>該当する本が見つかりませんでした。</p>
    {% endif %}
</section>

<!-- ソート＆フィルター -->
<div id="filter-menu" class="filter-menu">
    <h2>ソート & フィルター</h2>
    <form method="GET" action="{% url 'search_books:search_books' %}">
        <input type="hidden" name="query" value="{{ query }}">
        <label for="sort">並び順:</label>
        <select name="sort" id="sort">
            <option value="relevance" {% if sort == "relevance" %}selected{% endif %}>関連順</option>
            <option value="newest" {% if sort == "newest" %}selected{% endif %}>新しい順</option>
        </select>

        <label for="language">言語:</label>
        <select name="language" id="language">
            <option value="">すべて</option>
            <option value="en" {% if language == "en" %}selected{% endif %}>英語</option>
            <option value="ja" {% if language == "ja" %}selected{% endif %}>日本語</option>
        </select>

        <button type="submit" class="btn">適用</button>
    </form>
    <button class="btn close-filter" onclick="toggleFilterMenu()">閉じる</button>
</div>
<button class="btn filter-toggle" onclick="toggleFilterMenu()">ソート & フィルター</button>
{% endblock %}
